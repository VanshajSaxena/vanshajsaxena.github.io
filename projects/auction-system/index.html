<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Auction Hub | @vanshaj.xyz</title>
<meta name="keywords" content="">
<meta name="description" content="Auction Hub is a backend service that is designed to serve a system of online
auctions, basically the buying, selling, and bidding of auction items in real
time, with a comprehensive focus on security of the application and its scalability.

Project Structure
Using Spring Boot,
OpenAPI and
eclipse.jdt.ls, the Auction
System is designed to be stable, secure and scalable. It follows an API-first
approach to allow for its client to know exactly what to expect from the API.">
<meta name="author" content="Vanshaj Saxena">
<link rel="canonical" href="https://vanshaj.xyz/projects/auction-system/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://vanshaj.xyz/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://vanshaj.xyz/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://vanshaj.xyz/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://vanshaj.xyz/apple-touch-icon.png">
<link rel="mask-icon" href="https://vanshaj.xyz/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://vanshaj.xyz/projects/auction-system/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://vanshaj.xyz/projects/auction-system/">
  <meta property="og:site_name" content="@vanshaj.xyz">
  <meta property="og:title" content="Auction Hub">
  <meta property="og:description" content="Auction Hub is a backend service that is designed to serve a system of online auctions, basically the buying, selling, and bidding of auction items in real time, with a comprehensive focus on security of the application and its scalability.
Project Structure Using Spring Boot, OpenAPI and eclipse.jdt.ls, the Auction System is designed to be stable, secure and scalable. It follows an API-first approach to allow for its client to know exactly what to expect from the API.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="projects">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Auction Hub">
<meta name="twitter:description" content="Auction Hub is a backend service that is designed to serve a system of online
auctions, basically the buying, selling, and bidding of auction items in real
time, with a comprehensive focus on security of the application and its scalability.

Project Structure
Using Spring Boot,
OpenAPI and
eclipse.jdt.ls, the Auction
System is designed to be stable, secure and scalable. It follows an API-first
approach to allow for its client to know exactly what to expect from the API.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Projects",
      "item": "https://vanshaj.xyz/projects/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Auction Hub",
      "item": "https://vanshaj.xyz/projects/auction-system/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Auction Hub",
  "name": "Auction Hub",
  "description": "Auction Hub is a backend service that is designed to serve a system of online auctions, basically the buying, selling, and bidding of auction items in real time, with a comprehensive focus on security of the application and its scalability.\nProject Structure Using Spring Boot, OpenAPI and eclipse.jdt.ls, the Auction System is designed to be stable, secure and scalable. It follows an API-first approach to allow for its client to know exactly what to expect from the API.\n",
  "keywords": [
    
  ],
  "articleBody": "Auction Hub is a backend service that is designed to serve a system of online auctions, basically the buying, selling, and bidding of auction items in real time, with a comprehensive focus on security of the application and its scalability.\nProject Structure Using Spring Boot, OpenAPI and eclipse.jdt.ls, the Auction System is designed to be stable, secure and scalable. It follows an API-first approach to allow for its client to know exactly what to expect from the API.\nThe project follows the following structure which allows it to be modular and maintainable to reducing cost of refactoring in future along with a test suit that tests the essential components of the application.\nauction-system/ ├── src/ │ ├── main/ │ │ ├── java/ │ │ │ └── com/ │ │ │ └── auction/ │ │ │ └── system/ # Main application package │ │ │ ├── config/ # Spring Security configuration classes │ │ │ ├── controllers/ # API Controllers (delegates to generated interfaces) │ │ │ ├── entities/ # JPA entities │ │ │ ├── exception/ # Custom exception handling │ │ │ ├── filters/ # Request filters (e.g. JWT authentication filter) │ │ │ ├── mappers/ # MapStruct mappers │ │ │ ├── repositories/ # Spring Data JPA repositories │ │ │ ├── security/ # Security related components │ │ │ ├── services/ # Business logic interfaces │ │ │ │ └── impl/ # Interface implementations │ │ │ └── AuctionSystemApplication.java # Spring Boot main class │ │ └── resources/ │ │ ├── api/ │ │ │ └── openapi.api-description.yaml # API description file │ │ ├── static/ │ │ ├── templates/ │ │ └── application.yaml # Application properties │ └── test/ # Test sources │ └── java/ │ └── com/ │ └── auction/ │ └── system/ │ ├── services/ │ │ └── impl/ # Service related tests │ └── testutils/ # Test utility classes ├── mvnw # Maven wrapper executable (Linux/MacOS) ├── mvnw.cmd # Maven wrapper executable (Windows) └── pom.xml # Maven Project Object Model The source-code can be found on my GitHub Profile.\nOpenAPI It uses OpenAPI spec 3.0.3 to define its contract. The API contract can be viewed interactively either by running the server offline and making a request to the swagger.html endpoint, which redirects to a Swagger UI page running locally. Or my directly inspecting the openapi.api-description.yaml fine in the project source code.\nThis approach allows the consumers of the API to beforehand know what to expect from the API and even generate client stubs for mocking and prototyping, saving time a cost of development.\nThe project workflow involves interacting with OpenAPI description file, if an endpoint needs to be added, the API description file can be updated to reflect that and the server stubs will be generated with openapi-generator during the generate-source phase of Maven default lifecycle.\nSecurity The API is secured using Spring Security with best practices in mind. It uses stateless authentication using JWTs (access_token and id_token). To enable SSO using third-party authorization and openid providers there are callback endpoints like /auth/{provider}/callback that expects an Authorization: Bearer header in the POST request.\nThe security scheme for these endpoints in OpenAPI description file looks like this:\npaths: /auth/google/callback: post: security: - oauth2google: [] /auth/apple/callback: post: security: - oauth2apple: [] components: securitySchemes: bearerAuth: type: http scheme: bearer description: Authorization using JWT issued by the backend. bearerFormat: JWT oauth2google: type: http scheme: bearer description: Authentication using ID Tokens from the Google Authorization Server. bearerFormat: ID Token (Google) oauth2apple: type: http scheme: bearer description: Authentication using ID Tokens from the Apple Authorization Server. bearerFormat: ID Token (Apple) security: - bearerAuth: [] To have a deeper look at the security scheme have a look at the SecurityConfig.java and OAuth2SecurityConfig in the com.auction.system.config package.\n",
  "wordCount" : "626",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Vanshaj Saxena"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://vanshaj.xyz/projects/auction-system/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "@vanshaj.xyz",
    "logo": {
      "@type": "ImageObject",
      "url": "https://vanshaj.xyz/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://vanshaj.xyz/" accesskey="h" title="@vanshaj.xyz (Alt + H)">@vanshaj.xyz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://vanshaj.xyz/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://vanshaj.xyz/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://vanshaj.xyz/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://vanshaj.xyz/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://vanshaj.xyz/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://vanshaj.xyz/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://vanshaj.xyz/">Home</a>&nbsp;»&nbsp;<a href="https://vanshaj.xyz/projects/">Projects</a></div>
    <h1 class="post-title entry-hint-parent">
      Auction Hub
    </h1>
    <div class="post-meta">Vanshaj Saxena

</div>
  </header> 
  <div class="post-content"><p><strong>Auction Hub</strong> is a backend service that is designed to serve a system of online
auctions, basically the buying, selling, and bidding of auction items in real
time, with a comprehensive focus on security of the application and its scalability.</p>
<hr>
<h2 id="project-structure">Project Structure<a hidden class="anchor" aria-hidden="true" href="#project-structure">#</a></h2>
<p>Using <a href="https://spring.io/projects/spring-boot">Spring Boot</a>,
<a href="https://www.openapis.org/what-is-openapi">OpenAPI</a> and
<a href="https://github.com/eclipse-jdtls/eclipse.jdt.ls">eclipse.jdt.ls</a>, the Auction
System is designed to be stable, secure and scalable. It follows an <strong>API-first</strong>
approach to allow for its client to know exactly what to expect from the API.</p>
<p>The project follows the following structure which allows it to be modular and
maintainable to reducing cost of refactoring in future along with a test suit
that tests the essential components of the application.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>auction-system/
</span></span><span style="display:flex;"><span>├── src/
</span></span><span style="display:flex;"><span>│   ├── main/
</span></span><span style="display:flex;"><span>│   │   ├── java/
</span></span><span style="display:flex;"><span>│   │   │   └── com/
</span></span><span style="display:flex;"><span>│   │   │       └── auction/
</span></span><span style="display:flex;"><span>│   │   │           └── system/     <span style="color:#75715e"># Main application package</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── config/         <span style="color:#75715e"># Spring Security configuration classes</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── controllers/    <span style="color:#75715e"># API Controllers (delegates to generated interfaces)</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── entities/       <span style="color:#75715e"># JPA entities</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── exception/      <span style="color:#75715e"># Custom exception handling</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── filters/        <span style="color:#75715e"># Request filters (e.g. JWT authentication filter)</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── mappers/        <span style="color:#75715e"># MapStruct mappers</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── repositories/   <span style="color:#75715e"># Spring Data JPA repositories</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── security/       <span style="color:#75715e"># Security related components</span>
</span></span><span style="display:flex;"><span>│   │   │               ├── services/       <span style="color:#75715e"># Business logic interfaces</span>
</span></span><span style="display:flex;"><span>│   │   │               │   └── impl/       <span style="color:#75715e"># Interface implementations</span>
</span></span><span style="display:flex;"><span>│   │   │               └── AuctionSystemApplication.java <span style="color:#75715e"># Spring Boot main class</span>
</span></span><span style="display:flex;"><span>│   │   └── resources/
</span></span><span style="display:flex;"><span>│   │       ├── api/
</span></span><span style="display:flex;"><span>│   │       │   └── openapi.api-description.yaml <span style="color:#75715e"># API description file</span>
</span></span><span style="display:flex;"><span>│   │       ├── static/
</span></span><span style="display:flex;"><span>│   │       ├── templates/
</span></span><span style="display:flex;"><span>│   │       └── application.yaml            <span style="color:#75715e"># Application properties</span>
</span></span><span style="display:flex;"><span>│   └── test/                               <span style="color:#75715e"># Test sources</span>
</span></span><span style="display:flex;"><span>│       └── java/
</span></span><span style="display:flex;"><span>│           └── com/
</span></span><span style="display:flex;"><span>│               └── auction/
</span></span><span style="display:flex;"><span>│                   └── system/
</span></span><span style="display:flex;"><span>│                       ├── services/
</span></span><span style="display:flex;"><span>│                       │   └── impl/       <span style="color:#75715e"># Service related tests</span>
</span></span><span style="display:flex;"><span>│                       └── testutils/      <span style="color:#75715e"># Test utility classes</span>
</span></span><span style="display:flex;"><span>├── mvnw                                    <span style="color:#75715e"># Maven wrapper executable (Linux/MacOS)</span>
</span></span><span style="display:flex;"><span>├── mvnw.cmd                                <span style="color:#75715e"># Maven wrapper executable (Windows)</span>
</span></span><span style="display:flex;"><span>└── pom.xml                                 <span style="color:#75715e"># Maven Project Object Model</span>
</span></span></code></pre></div><p>The <a href="https://github.com/VanshajSaxena/auction-system">source-code</a> can be found
on my GitHub Profile.</p>
<hr>
<h2 id="openapi">OpenAPI<a hidden class="anchor" aria-hidden="true" href="#openapi">#</a></h2>
<p>It uses OpenAPI spec 3.0.3 to define its contract. The API contract can be
viewed interactively either by running the server offline and making a request
to the <code>swagger.html</code> endpoint, which redirects to a Swagger UI page running
locally. Or my directly inspecting the
<a href="https://github.com/VanshajSaxena/auction-system/blob/master/src/main/resources/api/openapi.api-description.yaml">openapi.api-description.yaml</a>
fine in the project source code.</p>
<p>This approach allows the consumers of the API to beforehand know what to expect
from the API and even generate client stubs for mocking and prototyping,
saving time a cost of development.</p>
<p>The project workflow involves interacting with OpenAPI description file, if an
endpoint needs to be added, the API description file can be updated to reflect
that and the server stubs will be generated with
<a href="https://github.com/OpenAPITools/openapi-generator">openapi-generator</a> during
the <code>generate-source</code> phase of Maven <code>default</code> lifecycle.</p>
<hr>
<h2 id="security">Security<a hidden class="anchor" aria-hidden="true" href="#security">#</a></h2>
<p>The API is secured using <a href="https://spring.io/projects/spring-security">Spring
Security</a> with best practices in
mind. It uses stateless authentication using JWTs (<code>access_token</code> and
<code>id_token</code>). To enable SSO using third-party authorization and openid providers
there are callback endpoints like <code>/auth/{provider}/callback</code> that expects an
<code>Authorization: Bearer &lt;token&gt;</code> header in the <code>POST</code> request.</p>
<p>The security scheme for these endpoints in OpenAPI description file looks like
this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">paths</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">/auth/google/callback</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">post</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">security</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">oauth2google</span>: []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">/auth/apple/callback</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">post</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">security</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#f92672">oauth2apple</span>: []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">components</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">securitySchemes</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">bearerAuth</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">http</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">bearer</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">description</span>: <span style="color:#ae81ff">Authorization using JWT issued by the backend.</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">bearerFormat</span>: <span style="color:#ae81ff">JWT</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">oauth2google</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">http</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">bearer</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">description</span>: <span style="color:#ae81ff">Authentication using ID Tokens from the Google Authorization Server.</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">bearerFormat</span>: <span style="color:#ae81ff">ID Token (Google)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">oauth2apple</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">http</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">scheme</span>: <span style="color:#ae81ff">bearer</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">description</span>: <span style="color:#ae81ff">Authentication using ID Tokens from the Apple Authorization Server.</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">bearerFormat</span>: <span style="color:#ae81ff">ID Token (Apple)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">security</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">bearerAuth</span>: []
</span></span></code></pre></div><p>To have a deeper look at the security scheme have a look at the
<code>SecurityConfig.java</code> and <code>OAuth2SecurityConfig</code> in the
<code>com.auction.system.config</code> package.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
